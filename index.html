<!DOCTYPE html> 
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ã˜ã‚…ã‚“å¿˜å¹´ä¼š å‡ºå¸­ãƒ•ã‚©ãƒ¼ãƒ </title>

  <style>
    body {
      font-family: "Hiragino Sans","Yu Gothic", sans-serif;
      padding: 15px;
      background: linear-gradient(#dff3ff, #ffffff);
      max-width: 480px;
      margin: auto;
      position: relative;
      overflow-x: hidden;
    }

    /* â„ï¸ è¦‹å‡ºã—ï¼ˆã‚¯ãƒªã‚¹ãƒã‚¹Ã—é›ªï¼‰ */
    h1, h2 {
      color: #e74c3c;
      border-bottom: 2px solid #2ecc71;
      padding-bottom: 5px;
      font-size: 1.35rem;
      text-shadow: 1px 1px 2px #fff;
    }

    label {
      font-weight: bold;
      color: #2c3e50;
    }

    select, input[type="password"] {
      padding: 12px;
      margin-top: 10px;
      border-radius: 12px;
      border: 1px solid #aac8d8;
      width: 100%;
      font-size: 1rem;
      background: rgba(255,255,255,0.9);
    }

    /* ğŸ„ ãƒœã‚¿ãƒ³é¡ */
    button {
      margin-top: 12px;
      padding: 12px;
      border: none;
      border-radius: 12px;
      background: #e74c3c;
      color: white;
      cursor: pointer;
      width: 100%;
      font-size: 1rem;
      font-weight: bold;
      box-shadow: 0 4px 8px rgba(180, 50, 50, 0.3);
      transition: 0.2s;
    }
    button:hover {
      background: #c0392b;
    }

    #seatInfo {
      margin-top: 15px;
      font-weight: bold;
      color: #2c3e50;
      font-size: 1.1rem;
      background: #fff7e6;
      padding: 10px;
      border-radius: 10px;
      border-left: 4px solid #e67e22;
    }

    /* ğŸ„ ç®¡ç†è€…ã‚¨ãƒªã‚¢ */
    #adminSection {
      display: none;
      margin-top: 20px;
      background-color: rgba(255, 255, 255, 0.85);
      padding: 15px;
      border-radius: 12px;
      box-shadow: 0 3px 6px rgba(0,0,0,0.1);
      backdrop-filter: blur(3px);
    }

    #adminList li {
      padding: 8px;
      border-bottom: 1px solid #ccc;
      font-size: 0.95rem;
    }

    /* ãƒªã‚»ãƒƒãƒˆãƒœã‚¿ãƒ³ã ã‘èµ¤ */
    #resetBtn {
      background-color: #c0392b;
    }
    #resetBtn:hover {
      background-color: #992d22;
    }

    /* â„ï¸ é›ªã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ */
    .snow {
      position: fixed;
      top: -10px;
      background: white;
      border-radius: 50%;
      opacity: 0.8;
      pointer-events: none;
      animation: fall 10s linear infinite;
      z-index: 999;
    }

    @keyframes fall {
      from { transform: translateY(-10px) translateX(0); }
      to   { transform: translateY(110vh) translateX(25px); }
    }
  </style>
</head>

<body>

  <h1>ğŸ„ ç„¼è‚‰ã˜ã‚…ã‚“ å¿˜å¹´ä¼š å‡ºå¸­ãƒ•ã‚©ãƒ¼ãƒ  â„ï¸</h1>

  <label for="name">åå‰ã‚’é¸æŠï¼š</label>
  <select id="name">
    <option value="">é¸æŠã—ã¦ãã ã•ã„</option>
  </select>

  <div id="seatInfo"></div>

  <button id="joinBtn">å‚åŠ ã™ã‚‹ ğŸ…</button>

  <h2>ğŸ”‘ ç®¡ç†è€…ãƒ­ã‚°ã‚¤ãƒ³</h2>
  <input type="password" id="adminPassword" placeholder="ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’å…¥åŠ›">
  <button id="adminLoginBtn">ãƒ­ã‚°ã‚¤ãƒ³</button>

  <div id="adminSection">
    <h2>å‚åŠ è€…ãƒªã‚¹ãƒˆï¼ˆãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ï¼‰</h2>
    <button id="resetBtn">ãƒªã‚¹ãƒˆã‚’ãƒªã‚»ãƒƒãƒˆ</button>
    <ul id="adminList"></ul>
  </div>

  <!-- Firebase SDK -->
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-app.js";
    import { getDatabase, ref, push, set, onValue, remove } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-database.js";

    const firebaseConfig = {
      apiKey: "AIzaSyCkJtoQYRUNbmkLyMMq2JXODX79wnXNp-Q",
      authDomain: "jun-attendance.firebaseapp.com",
      databaseURL: "https://jun-attendance-default-rtdb.asia-southeast1.firebasedatabase.app",
      projectId: "jun-attendance",
      storageBucket: "jun-attendance.firebasestorage.app",
      messagingSenderId: "1026360314641",
      appId: "1:1026360314641:web:84ecac98f023da34b31ab0"
    };

    const app = initializeApp(firebaseConfig);
    const db = getDatabase(app);

    const participantsData = [
      { number: 1 , name: "å‰å·", table: "A07"},
      { number: 2, name: "æ‘ä¸Š", table: "A07" },
      { number: 3, name: "é‡æ‘", table: "A07" },
      { number: 4, name: "ç”°æ‘", table: "A07" },
      { number: 5, name: "èµ¤å¸", table: "A07" },
      { number: 6, name: "å†…å±±", table: "A07" },
      { number: 7, name: "å±±æœ¬", table: "A08" },
      { number: 8, name: "å‰åŸ", table: "A08" },
      { number: 9, name: "æ°´å£", table: "A08" },
      { number: 10, name: "å¯Œå±±", table: "A08" },
      { number: 11, name: "é´»å±±", table: "A08" },
      { number: 12, name: "ç”°ä¸­", table: "A08" },
      { number: 13, name: "å¡šæœ¬", table: "A09" },
      { number: 14, name: "æ¢¶äº•", table: "A09" },
      { number: 15, name: "å¢—åŸ", table: "A09" },
      { number: 16, name: "ç™½ç”°", table: "A09" },
      { number: 17, name: "æ£®", table: "A10" },
      { number: 18, name: "ä¸­å±±", table: "A10" },
      { number: 19, name: "è‚¥å¡š", table: "A10" },
      { number: 20, name: "ç”°é ­", table: "A10" },
      { number: 21, name: "ä¸­è°·", table: "A10" },
    ];

    const nameSelect = document.getElementById("name");
    const seatInfo = document.getElementById("seatInfo");
    const joinBtn = document.getElementById("joinBtn");
    const adminLoginBtn = document.getElementById("adminLoginBtn");
    const adminPasswordInput = document.getElementById("adminPassword");
    const adminSection = document.getElementById("adminSection");
    const adminList = document.getElementById("adminList");
    const resetBtn = document.getElementById("resetBtn");
    const ADMIN_PASSWORD = "20061030";

    /* åå‰ãƒªã‚¹ãƒˆç”Ÿæˆ */
    participantsData.forEach(p => {
      const option = document.createElement("option");
      option.value = p.name;
      option.textContent = p.name;
      nameSelect.appendChild(option);
    });

    /* å‚åŠ ãƒœã‚¿ãƒ³ */
    joinBtn.addEventListener("click", () => {
      const selectedName = nameSelect.value;
      if (!selectedName) return alert("åå‰ã‚’é¸æŠã—ã¦ãã ã•ã„ ğŸ„");

      const person = participantsData.find(p => p.name === selectedName);

      if (!confirm(`ã€Œ${selectedName}ã€ã•ã‚“ã§é–“é•ã„ãªã„ï¼Ÿ`)) return;

      seatInfo.textContent = `ã‚ãªãŸã®å¸­ã¯ ğŸ„ ${person.table}å“ ï¼ ${person.number}ç•ª ã§ã™ â„ï¸`;

      const participantRef = ref(db, "participants/" + person.name);
      set(participantRef, {
        name: person.name,
        number: person.number,
        table: person.table,
        timestamp: new Date().toLocaleString()
      });

      alert("å‚åŠ ã‚’è¨˜éŒ²ã—ã¾ã—ãŸï¼â›„");
    });

    /* ç®¡ç†è€…ãƒ­ã‚°ã‚¤ãƒ³ */
    adminLoginBtn.addEventListener("click", () => {
      if (adminPasswordInput.value === ADMIN_PASSWORD) {
        alert("ç®¡ç†è€…ãƒ­ã‚°ã‚¤ãƒ³æˆåŠŸ ğŸ„");
        adminSection.style.display = "block";
        adminPasswordInput.value = "";
      } else {
        alert("ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãŒé•ã„ã¾ã™ âŒ");
      }
    });

    /* å‚åŠ è€…ä¸€è¦§ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ  */
    const participantsRef = ref(db, "participants");
    onValue(participantsRef, (snapshot) => {
      adminList.innerHTML = "";
      snapshot.forEach((child) => {
        const data = child.val();
        const li = document.createElement("li");
        li.textContent = `${data.number}ç•ª - ${data.name} (${data.table})`;
        adminList.appendChild(li);
      });
    });

    /* ãƒªã‚»ãƒƒãƒˆ */
    resetBtn.addEventListener("click", () => {
      if (confirm("æœ¬å½“ã«ãƒªã‚¹ãƒˆã‚’å‰Šé™¤ã—ã¾ã™ã‹ï¼Ÿâ„ï¸")) {
        remove(participantsRef);
      }
    });

  </script>

  <!-- â„ï¸ é›ªã®ã‚¨ãƒ•ã‚§ã‚¯ãƒˆç”Ÿæˆ -->
  <script>
    for (let i = 0; i < 25; i++) {
      const snow = document.createElement("div");
      snow.className = "snow";
      snow.style.left = Math.random() * 100 + "vw";
      snow.style.animationDuration = 8 + Math.random() * 5 + "s";
      snow.style.opacity = Math.random();
      snow.style.width = snow.style.height = 5 + Math.random() * 6 + "px";
      document.body.appendChild(snow);
    }
  </script>

</body>
</html>
