<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ã˜ã‚…ã‚“å¿˜å¹´ä¼š å‡ºå¸­ãƒ•ã‚©ãƒ¼ãƒ </title>

  <style>
    body {
      font-family: "Hiragino Sans","Yu Gothic", sans-serif;
      padding: 15px;
      background: linear-gradient(#dff3ff, #ffffff);
      max-width: 480px;
      margin: auto;
      position: relative;
      overflow-x: hidden;
    }

    h1, h2 {
      color: #e74c3c;
      border-bottom: 2px solid #2ecc71;
      padding-bottom: 5px;
      font-size: 1.35rem;
      text-shadow: 1px 1px 2px #fff;
    }

    label {
      font-weight: bold;
      color: #2c3e50;
    }

    select, input[type="password"] {
      padding: 12px;
      margin-top: 10px;
      border-radius: 12px;
      border: 1px solid #aac8d8;
      width: 100%;
      font-size: 1rem;
      background: rgba(255,255,255,0.9);
    }

    button {
      margin-top: 12px;
      padding: 12px;
      border: none;
      border-radius: 12px;
      background: #e74c3c;
      color: white;
      cursor: pointer;
      width: 100%;
      font-size: 1rem;
      font-weight: bold;
      box-shadow: 0 4px 8px rgba(180, 50, 50, 0.3);
      transition: 0.2s;
    }

    button:hover {
      background: #c0392b;
    }

    #seatInfo {
      margin-top: 15px;
      font-weight: bold;
      color: #2c3e50;
      font-size: 1.1rem;
      background: #fff7e6;
      padding: 10px;
      border-radius: 10px;
      border-left: 4px solid #e67e22;
    }

    #adminSection {
      display: none;
      margin-top: 20px;
      background-color: rgba(255, 255, 255, 0.9);
      padding: 15px;
      border-radius: 12px;
      box-shadow: 0 3px 6px rgba(0,0,0,0.1);
    }

    #adminList li {
      padding: 8px;
      border-bottom: 1px solid #ccc;
      font-size: 0.95rem;
    }

    #resetBtn {
      background-color: #c0392b;
    }

    .snow {
      position: fixed;
      top: -10px;
      background: white;
      border-radius: 50%;
      opacity: 0.8;
      pointer-events: none;
      animation: fall 10s linear infinite;
      z-index: 999;
    }

    @keyframes fall {
      from { transform: translateY(-10px) translateX(0); }
      to   { transform: translateY(110vh) translateX(25px); }
    }
  </style>
</head>

<body>

<h1>ğŸ„ ç„¼è‚‰ã˜ã‚…ã‚“ å¿˜å¹´ä¼š å‡ºå¸­ãƒ•ã‚©ãƒ¼ãƒ  â„ï¸</h1>

<label>åå‰ã‚’é¸æŠï¼š</label>
<select id="name">
  <option value="">é¸æŠã—ã¦ãã ã•ã„</option>
</select>

<div id="seatInfo"></div>

<button id="joinBtn">å‚åŠ ã™ã‚‹ ğŸ…</button>

<h2>ğŸ”‘ å‚åŠ ç¢ºèªãƒ­ã‚°ã‚¤ãƒ³</h2>
<input type="password" id="adminPassword" placeholder="ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’å…¥åŠ›">
<button id="adminLoginBtn">ãƒ­ã‚°ã‚¤ãƒ³</button>

<div id="adminSection">
  <h2>å‚åŠ è€…ãƒªã‚¹ãƒˆï¼ˆãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ï¼‰</h2>
  <button id="resetBtn">ãƒªã‚¹ãƒˆã‚’ãƒªã‚»ãƒƒãƒˆ</button>
  <ul id="adminList"></ul>
</div>

<!-- Firebase -->
<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-app.js";
  import { getDatabase, ref, push, set, onValue, remove } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-database.js";

  /* ğŸ”¥ Firebaseè¨­å®šï¼ˆãã®ã¾ã¾ä½¿ã£ã¦OKï¼‰ */
  const firebaseConfig = {
    apiKey: "YOUR_API_KEY",
    authDomain: "jun-attendance-2506c.firebaseapp.com",
    databaseURL: "https://jun-attendance-2506c-default-rtdb.asia-southeast1.firebasedatabase.app",
    projectId: "jun-attendance-2506c",
    storageBucket: "jun-attendance-2506c.appspot.com",
    messagingSenderId: "XXXX",
    appId: "XXXX"
  };

  const app = initializeApp(firebaseConfig);
  const db = getDatabase(app);

  const ADMIN_PASSWORD = "20061030";

  const participantsData = [
    { number: 1 , name: "å‰å·", table: "A07"},
    { number: 2 , name: "æ‘ä¸Š", table: "A07"},
    { number: 3 , name: "é‡æ‘", table: "A07"},
    { number: 4 , name: "ç”°æ‘", table: "A07"},
    { number: 5 , name: "èµ¤å¸", table: "A07"},
    { number: 6 , name: "å†…å±±", table: "A07"},
    { number: 7 , name: "å±±æœ¬", table: "A08"},
    { number: 8 , name: "å‰åŸ", table: "A08"},
    { number: 9 , name: "æ°´å£", table: "A08"},
    { number: 10, name: "å¯Œå±±", table: "A08"},
    { number: 11, name: "é´»å±±", table: "A08"},
    { number: 12, name: "ç”°ä¸­", table: "A08"},
    { number: 13, name: "å¡šæœ¬", table: "A09"},
    { number: 14, name: "æ¢¶äº•", table: "A09"},
    { number: 15, name: "å¢—åŸ", table: "A09"},
    { number: 16, name: "ç™½ç”°", table: "A09"},
    { number: 17, name: "æ£®", table: "A10"},
    { number: 18, name: "ä¸­å±±", table: "A10"},
    { number: 19, name: "è‚¥å¡š", table: "A10"},
    { number: 20, name: "ç”°é ­", table: "A10"},
    { number: 21, name: "ä¸­è°·", table: "A10"}
  ];

  const nameSelect = document.getElementById("name");
  const seatInfo = document.getElementById("seatInfo");
  const adminSection = document.getElementById("adminSection");
  const adminList = document.getElementById("adminList");

  participantsData.forEach(p => {
    const opt = document.createElement("option");
    opt.value = p.name;
    opt.textContent = p.name;
    nameSelect.appendChild(opt);
  });

  document.getElementById("joinBtn").onclick = () => {
    const name = nameSelect.value;
    if (!name) return alert("åå‰ã‚’é¸æŠã—ã¦ãã ã•ã„");

    const p = participantsData.find(x => x.name === name);
    if (!confirm(`${name}ã•ã‚“ã§é–“é•ã„ãªã„ï¼Ÿ`)) return;

    seatInfo.textContent = `ã‚ãªãŸã®å¸­ï¼š${p.table}å“ ï¼ ${p.number}ç•ª`;

    const newRef = push(ref(db, "participants"));
    set(newRef, {
      name: p.name,
      number: p.number,
      table: p.table,
      time: new Date().toLocaleString()
    })
    .then(() => alert("å‚åŠ ã‚’è¨˜éŒ²ã—ã¾ã—ãŸï¼"))
    .catch(e => alert("Firebaseã‚¨ãƒ©ãƒ¼\n" + e.message));
  };

  document.getElementById("adminLoginBtn").onclick = () => {
    if (document.getElementById("adminPassword").value === ADMIN_PASSWORD) {
      adminSection.style.display = "block";
      alert("ç®¡ç†è€…ãƒ­ã‚°ã‚¤ãƒ³æˆåŠŸ");
    } else {
      alert("ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãŒé•ã„ã¾ã™");
    }
  };

  const participantsRef = ref(db, "participants");
  onValue(participantsRef, snap => {
    adminList.innerHTML = "";
    snap.forEach(c => {
      const d = c.val();
      const li = document.createElement("li");
      li.textContent = `${d.number}ç•ª ${d.name} (${d.table})`;
      adminList.appendChild(li);
    });
  });

  document.getElementById("resetBtn").onclick = () => {
    if (confirm("æœ¬å½“ã«ãƒªã‚»ãƒƒãƒˆï¼Ÿ")) remove(participantsRef);
  };
</script>

<script>
  for (let i = 0; i < 25; i++) {
    const s = document.createElement("div");
    s.className = "snow";
    s.style.left = Math.random() * 100 + "vw";
    s.style.width = s.style.height = 5 + Math.random() * 6 + "px";
    s.style.animationDuration = 8 + Math.random() * 5 + "s";
    document.body.appendChild(s);
  }
</script>

</body>
</html>
